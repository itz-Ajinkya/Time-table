<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>üóìÔ∏è Timetable [Sem II]</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='50' y='50' font-size='72' text-anchor='middle' dominant-baseline='central'%3EüóìÔ∏è%3C/text%3E%3C/svg%3E">
    
    <style>
        @import url('https://fonts.cdnfonts.com/css/cascadia-code');

        :root {
            /* Light Mode */
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #7f8c8d;
            --border: #e1e4e8;
            --input-bg: #f8f9fa;
            --input-focus-bg: #ffffff;
            --live-color: #2ecc71;
            --error: #e74c3c;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --slot-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* Dark Mode */
        body.dark-mode {
            --primary: #ecf0f1;
            --accent: #5dade2;
            --bg: #121212;
            --card-bg: #1e1e1e;
            --text-main: #e0e0e0;
            --text-sub: #b0b3b8;
            --border: #333333;
            --input-bg: #2c2c2c;
            --input-focus-bg: #333333;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.3);
            --slot-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .hidden { display: none !important; }
        .container { max-width: 100%; margin: 0 auto; padding: 15px; }

        /* ============================
           PAGE 1: LOGIN
           ============================ */
        #home-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #2c3e50 0%, #2980b9 100%);
            padding: 20px;
            position: relative;
        }

        .theme-toggle-fixed {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            backdrop-filter: blur(5px);
            font-size: 1.2rem;
            z-index: 100;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 25px;
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            text-align: center;
            width: 100%;
            max-width: 380px;
            transition: transform 0.4s;
            animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        body.dark-mode .login-card { background: rgba(30, 30, 30, 0.95); }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .login-card h1 { 
            margin: 0 0 5px; 
            color: #2c3e50; 
            font-size: 1.6rem; 
            font-family: 'Cascadia Code', 'Fira Code', 'Courier New', monospace;
            font-weight: 600; 
            letter-spacing: -0.5px;
        }
        body.dark-mode .login-card h1 { color: #fff; }
        .login-card p { color: #666; margin-bottom: 25px; font-size: 0.9rem; }
        body.dark-mode .login-card p { color: #aaa; }

        /* UNIFIED INPUT STYLING */
        .mis-input-wrapper {
            display: flex;
            align-items: center;
            background: var(--input-bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 0 16px;
            transition: all 0.3s ease;
            cursor: text;
            margin-bottom: 20px;
        }
        
        .mis-input-wrapper:focus-within {
            border-color: var(--accent);
            background: var(--input-focus-bg);
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
        }

        .prefix {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--text-main);
            user-select: none;
            opacity: 0.7;
            letter-spacing: 2px;
        }

        .mis-input-wrapper input {
            border: none;
            background: transparent;
            padding: 16px 0 16px 2px;
            font-size: 1.4rem;
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: var(--text-main);
            outline: none;
            width: 100%;
            letter-spacing: 2px;
        }

        .btn-login {
            background: var(--accent);
            color: white;
            border: none;
            padding: 16px 0;
            width: 100%;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
            transition: transform 0.2s;
        }
        .btn-login:active { transform: scale(0.98); }

        .error-msg {
            color: var(--error);
            font-size: 0.85rem;
            margin-top: 20px;
            font-weight: 600;
            display: none;
            background: rgba(231, 76, 60, 0.1);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--error);
        }

        .home-credit {
            position: absolute;
            bottom: 25px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .shake { animation: shake 0.4s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }

        /* ============================
           PAGE 2: DASHBOARD
           ============================ */
        
        header {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            border-bottom: 3px solid var(--accent);
            display: flex;
            flex-direction: column;
            gap: 15px;
            transition: background 0.3s;
        }

        .header-top { display: flex; justify-content: space-between; align-items: flex-start; }
        .profile-info h1 { margin: 0; font-size: 1.4rem; color: var(--primary); }
        .profile-info p { margin: 2px 0 0; color: var(--text-sub); font-size: 0.85rem; }

        .header-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg);
            padding: 10px;
            border-radius: 10px;
        }
        
        .btn-group { display: flex; gap: 10px; align-items: center; }

        .theme-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s;
        }
        .theme-btn:hover { background: rgba(0,0,0,0.05); }
        body.dark-mode .theme-btn:hover { background: rgba(255,255,255,0.1); }

        .logout-btn {
            background: var(--card-bg);
            color: var(--error);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
        }

        .clock-container {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: var(--accent);
            font-size: 1rem;
            min-width: 110px;
            text-align: right;
        }

        /* üé¥ CARDS */
        .cards {
            display: flex;
            overflow-x: auto;
            gap: 12px;
            padding-bottom: 10px;
            margin-bottom: 20px;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }
        .cards::-webkit-scrollbar { display: none; }
        
        .card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 14px;
            box-shadow: var(--card-shadow);
            min-width: 140px;
            scroll-snap-align: start;
            border-left: 4px solid #ccc;
            flex-shrink: 0;
            transition: background 0.3s;
            position: relative; /* allow absolute-positioned emojis inside cards */
        }

        .card h3 { margin: 0 0 5px; font-size: 0.85rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }
        .card .subject { font-size: 1.6rem; font-weight: 800; color: inherit; margin-bottom: 2px; }

        /* Enforce consistent top-right placement for emoji tags */
        .slot .lab-tag, .split-item .lab-tag, .card .lab-tag {
            position: absolute !important;
            top: 6px !important;
            right: 8px !important;
            transform: none !important;
            z-index: 3 !important;
        }
        .lab-tag { display: inline-block; pointer-events: none; text-align: center; }
        /* Division and batch boxes: white background with black text */
        .card .detail, .card .batch {
            font-size: 0.95rem;
            font-weight: 600;
            color: #111 !important;
            background: #ffffff !important;
            display: inline-block;
            padding: 6px 8px;
            border-radius: 8px;
            margin-top: 6px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.04);
        }
        @media (max-width: 640px) {
            .card .detail, .card .batch { font-size: 0.85rem; padding: 4px 6px; }
        }

        /* Timetable Grid */
        .timetable-wrapper {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            position: relative;
            transition: background 0.3s;
        }

        .table-scroll-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
        }

        table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 820px; }

        th { 
            background-color: var(--primary); 
            color: var(--bg);
            padding: 12px; 
            font-size: 0.8rem; 
            text-transform: uppercase;
            position: sticky;
            top: 0;
            z-index: 5;
        }
        body.dark-mode th { color: #121212; }

        td:first-child, th:first-child {
            position: sticky;
            left: 0;
            background: var(--card-bg);
            z-index: 6;
            border-right: 2px solid var(--border);
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
        }
        th:first-child { background: var(--primary); z-index: 7; }

        td { 
            padding: 8px;
            vertical-align: top;
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
            height: 90px; 
        }
        /* Make each day column wider so text doesn't collide with emoji; first column (time) is excluded */
        th:not(:first-child), td:not(.time-col) { min-width: 120px; }
        
        /* Increase table min-width to accommodate wider day columns */
        table { min-width: 820px; }
        
        .time-col { 
            font-weight: 700; 
            color: var(--text-sub); 
            text-align: center; 
            vertical-align: middle; 
            font-size: 0.95rem; 
            background: var(--bg) !important; 
            width: 95px;
            padding: 5px;
            line-height: 1.3;
        }

        /* SLOT STYLING */
        .slot {
            position: relative;
            border-radius: 8px;
            padding: 6px;
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            transition: all 0.3s ease;
            color: #333;
            box-shadow: var(--slot-shadow);
            overflow: visible;
        }
        /* Make room tag appear as a separate line below the title for clarity */
        .slot .room-tag, .split-item .room-tag { display: block; margin-top: 6px; }
        
        .lab-tag { 
            position: absolute;
            top: 4px;
            right: 6px;
            font-size: 2rem;
            line-height: 1;
            z-index: 2;
            transition: opacity 0.18s ease, transform 0.18s ease;
            pointer-events: none;
            transform: none !important; /* ensure no centering transforms */
            display: inline-block; /* ensure correct box behavior */
            text-align: center;
        }
        /* Ensure positioning context exists for both slot and split items */
        .slot, .split-item { position: relative; }
        /* Give slots extra right padding so emoji in the top-right never overlaps slot content */
        .slot, .split-item { padding-right: 36px; }
        /* Slot title/subheading styling: keep title on one line and LAB as a subheading */
        .slot .slot-title, .split-item .slot-title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }
        .slot .slot-sub, .split-item .slot-sub { display: block; font-weight: 700; font-size: 0.9rem; margin-top: 2px; }
        /* Utility: force any emoji intended for top-right to be absolutely positioned */
        .emoji-top-right { position: absolute !important; top: 6px !important; right: 6px !important; transform: none !important; z-index: 3 !important; }
        /* Mobile tweak: smaller lab-tag and anchored top-right */
        @media (max-width: 640px) {
            .lab-tag { font-size: 1.25rem; top: 6px; right: 6px; }
            .emoji-top-right { top: 6px !important; right: 6px !important; }
        }

        /* When hovering, hide emoji tag to avoid overlap with expanding extra-info */
        .slot:hover .lab-tag,
        .slot.slot-collision:hover .lab-tag,
        .split-item:hover .lab-tag {
            opacity: 0;
            transform: translateY(-6px);
        }

        /* Split-slot (collision) layout */
        .slot-collision { position: relative; padding: 6px; }
        .slot-split { display:flex; gap:6px; height:100%; align-items:stretch; }
        .slot-split .split-item { flex:1; min-width:0; border-radius:6px; padding:6px; display:flex; flex-direction:column; align-items:center; justify-content:center; position:relative; overflow:hidden; }
        /* Collision badge removed visually (kept class for compatibility) */
        .collision-tag { display: none !important; }
        /* Previously we hid on hover; not needed since badge is removed */
        .slot:hover .collision-tag { display: none !important; }
        
        /* Room tag: larger and bold */
        .room-tag { background: rgba(255,255,255,0.9); color: #111; font-size: 0.95rem; padding: 4px 6px; border-radius: 6px; margin-top: 6px; font-weight: 800; display: inline-block; }

        /* Hover Reveal */
        .slot .extra-info,
        .slot .extra-info * {
            max-height: 0;
            opacity: 0;
            font-size: 0.85rem;
            font-weight: 500;
            background: rgba(255,255,255,0.3);
            padding: 0 4px;
            border-radius: 4px;
            margin-top: 4px;
            transition: all 0.3s ease;
            overflow: hidden;
            color: #333 !important;
        }

        .slot:hover .extra-info, .slot:active .extra-info,
        .slot:hover .extra-info *, .slot:active .extra-info * {
            max-height: 40px;
            opacity: 1;
            margin-top: 4px;
            padding: 4px;
            color: #111 !important; /* Force division/batch text black on hover */
        }
        .slot:hover { transform: scale(1.05); z-index: 20; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }

        /* Colors - Updated to use classes generated by Logic.js */
        .ds, .vcde { background: #e8f8f5; color: #16a085; border-left: 3px solid #16a085; }
        .fms, .eemi, .bmt { background: #fef9e7; color: #d35400; border-left: 3px solid #f39c12; }
        .qp, .ep, .feet { background: #eaf2f8; color: #2980b9; border-left: 3px solid #2980b9; }
        .ps, .wd, .pp, .aeiot { background: #f4ecf7; color: #8e44ad; border-left: 3px solid #8e44ad; }
        .pd, .cs, .mpfl, .eva { background: #fdedec; color: #c0392b; border-left: 3px solid #c0392b; }
        .dpv, .caed, .bms { background: #ebf5fb; color: #2c3e50; border-left: 3px solid #34495e; }
        .fpi, .ae101 { background: #ffe0b2; color: #e67e22; border-left: 3px solid #e67e22; }
        .eva-slot, .rkmi { background: #d7bde2; color: #8e44ad; border-left: 3px solid #8e44ad; }

        /* Top cards: much fainter backgrounds than slot tiles (use very low alpha RGBA) */
        .card.qp, .card.ep, .card.feet { background: rgba(41,128,185,0.06); color: #2980b9; border-left: 4px solid #2980b9; }
        .card.ps, .card.wd, .card.pp, .card.aeiot { background: rgba(142,68,173,0.06); color: #8e44ad; border-left: 4px solid #8e44ad; }
        .card.pd, .card.cs, .card.mpfl, .card.eva { background: rgba(192,57,43,0.06); color: #c0392b; border-left: 4px solid #c0392b; }
        .card.dpv, .card.caed, .card.bms { background: rgba(52,73,94,0.04); color: #34495e; border-left: 4px solid #34495e; }
        .card.ds, .card.vcde { background: rgba(22,160,133,0.06); color: #16a085; border-left: 4px solid #16a085; }
        .card.fms, .card.fpi, .card.ae101, .card.bmt { background: rgba(243,156,18,0.04); color: #f39c12; border-left: 4px solid #f39c12; }

        .break { 
            background: var(--bg); 
            color: var(--text-sub); 
            font-style: italic; 
            font-weight: 500; 
            font-size: 0.8rem; 
            text-align: center !important;
            vertical-align: middle !important;
        }

        /* Lunch break should use Cascadia Code SemiBold for emphasis on mobile and desktop */
        #lunch-break {
            font-family: 'Cascadia Code', 'Fira Code', 'Courier New', monospace;
            font-weight: 600; /* SemiBold look */
            font-size: 0.95rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-style: normal; /* override general .break italic */
            position: relative; /* for absolutely positioned emojis */
            overflow: visible;
        }

        /* When lunch is live/active, highlight the lunch cell and show embedded emojis */
        #lunch-break.lunch-now {
            border: 3px solid var(--accent);
            border-radius: 10px;
            box-shadow: 0 8px 30px rgba(52,152,219,0.12);
            background: linear-gradient(180deg, rgba(52,152,219,0.03), transparent);
            animation: lunchPulse 1.6s ease-in-out infinite alternate;
        }

        @keyframes lunchPulse {
            from { box-shadow: 0 6px 22px rgba(52,152,219,0.06); }
            to { box-shadow: 0 10px 40px rgba(52,152,219,0.12); }
        }

        /* Smooth rising lunch emojis (start bottom, float up, fade out at top) */
        .lb-text { position: relative; z-index: 4; display: inline-block; padding: 6px 10px; letter-spacing: 1px; }

        .lunch-emoji {
            position: absolute;
            display: inline-block;
            pointer-events: none;
            user-select: none;
            bottom: 6px;
            transform: translateX(-50%) translateY(0) scale(1);
            animation-name: lunchRise;
            animation-timing-function: cubic-bezier(0.22, 0.9, 0.28, 1);
            animation-iteration-count: infinite;
            will-change: transform, opacity;
            z-index: 1; /* behind the text */
            text-shadow: 0 1px 2px rgba(0,0,0,0.06);
            opacity: 0;
        }

        @keyframes lunchRise {
            0% { transform: translateX(-50%) translateY(0) scale(0.9); opacity: 0; }
            12% { opacity: 1; }
            70% { transform: translateX(-50%) translateY(-90%) scale(1.02); opacity: 1; }
            100% { transform: translateX(-50%) translateY(-160%) scale(1.05); opacity: 0; }
        }

        .live-active { 
            box-shadow: 0 0 0 3px var(--live-color), 0 6px 18px rgba(46, 204, 113, 0.36) !important; 
            transform: scale(1.03); 
            z-index: 10; 
            position: relative;
            overflow: visible;
        }
        /* Decorative vertical LIVE badges on both sides of the live slot */
        .live-active::before,
        .live-active::after {
            content: "LIVE";
            position: absolute;
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
            background: var(--live-color);
            color: white;
            font-family: 'Arial Black', 'Impact', sans-serif;
            font-size: 0.62rem; /* reduced size */
            padding: 4px 8px; /* reduced padding */
            border-radius: 4px;
            letter-spacing: 0.8px;
            text-shadow: 0 0 0 rgba(0,0,0,0.06);
            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
            z-index: 22;
            white-space: nowrap;
            opacity: 0.96;
        }
        .live-active::before { left: -24px; transform: translateY(-50%) rotate(-90deg); }
        .live-active::after { right: -24px; transform: translateY(-50%) rotate(90deg); }

        /* Ensure slot content appears above snow overlay */
        .slot > *, .split-item > *, .slot .extra-info, .split-item .extra-info { position: relative; z-index: 3; }

        /* Snowfall overlay for live class slots (smooth, continuous fall; behind content) */
        .snowfall { position: absolute; inset: 0; pointer-events: none; overflow: hidden; border-radius: inherit; z-index: 1; }
        .snowflake {
            position: absolute; display: block; pointer-events: none;
            opacity: 0.48; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.08));
            will-change: top, transform, opacity;
        }
        /* Fall animates `top` (continuous linear), sway animates `transform` for gentle motion */
        .snowflake { animation-name: fall, sway; animation-timing-function: linear, ease-in-out; animation-iteration-count: infinite, infinite; }
        @keyframes fall { from { top: -12%; } to { top: 110%; } }
        @keyframes sway { 0% { transform: translateX(0) rotate(0deg) } 50% { transform: translateX(8px) rotate(8deg) } 100% { transform: translateX(0) rotate(0deg) } }
        /* Slight lift for contrast in both themes */
        .snowflake { text-shadow: 0 1px 0 rgba(255,255,255,0.12); }


        /* Emphasize footer: larger and superbold for better legibility */
        footer { 
            text-align: center; 
            margin-top: 30px; 
            font-size: 1rem; 
            color: var(--text-sub); 
            padding-bottom: 30px; 
            font-weight: 900; /* superbold */
            font-family: 'Cascadia Code', 'Fira Code', 'Courier New', monospace;
            letter-spacing: 0.6px;
        }
        
        .current-day-col { background-color: rgba(52, 152, 219, 0.1); }
        th.current-day-col { background-color: #34495e; border-bottom: 3px solid var(--accent); }
        body.dark-mode th.current-day-col { color: white; }

        /* ============================
           MOBILE IMPROVEMENTS
           - larger touch targets
           - avoid hover-only interactions
           - reduce table min-width to make horizontal scrolling usable
           - enable expanded slot views on tap
        */
        @media (max-width: 640px) {
            html, body { font-size: 16px; }
            .container { padding: 12px; }
            header { padding: 12px; border-radius: 12px; }
            .header-top { flex-direction: row; gap: 10px; align-items: center; }
            .cards { gap: 10px; padding-bottom: 8px; }
            .card { min-width: 120px; padding: 12px; }
            .timetable-wrapper { border-radius: 12px; }
            /* Keep table horizontally scrollable but with smaller min width */
            table { min-width: 600px; }
            td { padding: 12px; height: auto; min-height: 70px; font-size: 0.95rem; }
            .time-col { width: 80px; font-size: 0.9rem; }
            .slot { padding: 10px; font-size: 1rem; border-radius: 10px; }
            .slot:hover { transform: none; }
            /* On mobile show a single-line truncated summary by default and allow tap-to-expand */
            .slot .extra-info { max-height: 1.2em; opacity: 1; padding: 4px; margin-top: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
            .slot.expanded .extra-info, .split-item.expanded .extra-info { max-height: 300px; white-space: normal; overflow: visible; }
            /* Slightly reduce slot text and ensure enough space from emoji */
            .slot, .split-item { font-size: 0.95rem; padding-right: 36px; }
            .slot .lab-tag { font-size: 1rem; top: 6px; right: 6px; }
            /* Smaller lab-tag inside split items (collision cells) */
            .split-item .lab-tag { font-size: 0.9rem; top: 6px; right: 6px; }
            .btn-login { padding: 18px 0; font-size: 1.1rem; }
            .mis-input-wrapper input { font-size: 1.2rem; padding: 12px 0; }
            .theme-toggle-fixed { top: 12px; right: 12px; }
            .split-item, .slot { touch-action: manipulation; -webkit-tap-highlight-color: rgba(0,0,0,0.06); }
            .extra-info { transition: none; }
            /* Larger, reachable controls */
            .logout-btn, .theme-btn { padding: 10px; min-width: 44px; min-height: 44px; }
        }

        /* Expanded class for tap to reveal */
        .slot.expanded .extra-info, .split-item.expanded .extra-info { max-height: 300px; opacity: 1; }

    </style>
</head>
<body>

    <div id="home-page">
        
        <div class="login-card">
            <h1><span aria-hidden="true">üóìÔ∏è</span> Timetable (SEM II)</h1>
            <p>Check your live schedule</p>
            
            <label style="display:block; text-align:left; font-weight:600; margin-bottom:8px; color:var(--text-main);">MIS Number</label>
            
            <div class="mis-input-wrapper" onclick="document.getElementById('mis-input').focus()">
                <span class="prefix">6125</span>
                <input type="tel" id="mis-input" placeholder="*****" maxlength="5" autocomplete="off" inputmode="numeric">
            </div>
            
            <button class="btn-login" onclick="attemptLogin()">VIEW TIMETABLE</button>
            <div class="error-msg" id="error-msg">‚ùå Incorrect MIS</div>
        </div>
        <div class="home-credit">Designed & Developed by Ajinkya Patil [AIML]</div>
    </div>

    <div id="timetable-page" class="hidden">
        <div class="container">
            <header>
                <div class="header-top">
                    <div class="profile-info">
                        <h1 id="user-name-display">Student</h1>
                        <p id="user-details-display">MIS: ---</p>
                    </div>
                    
                    <div class="btn-group">
                        <button class="theme-btn" id="theme-toggle-btn" onclick="toggleTheme(); updateThemeButton();" title="Toggle theme" aria-label="Toggle theme">üåë</button>
                    </div>
                </div>
                
                <div class="header-actions">
                    <div id="clock" class="clock-container">--:--:--</div>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </header>

            <div class="cards" id="subject-cards-container"></div>

            <div class="timetable-wrapper">
                <div class="table-scroll-container" id="scroll-container">
                    <table id="main-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th id="th-mon">Mon</th>
                                <th id="th-tue">Tue</th>
                                <th id="th-wed">Wed</th>
                                <th id="th-thu">Thu</th>
                                <th id="th-fri">Fri</th>
                                <th id="th-sat">Sat</th>
                            </tr>
                        </thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>
            
            <footer>
                <p>Designed & Developed by Ajinkya Patil [AIML]</p>
            </footer>
        </div>
    </div>

<script src="students.js"></script>
<script src="logic.js"></script>

<script>
    // Loader diagnostic
    console.log('index.html loader:', 'GENERATED_DB=', typeof GENERATED_DB, 'getStudentData=', typeof getStudentData);

    let clockInterval;
    let currentUserSchedule = null;

    // Global group color map so both cards and table slots use the same colors
    // Each group now has a light background hex to use for faint table cards.
    window.GROUP_COLOR_MAP = {
        blueGroup: { codes: ['EP','QP','EC'], color: '#2980b9', bg: '#EAF4FF' },
        purpleGroup: { codes: ['PS','VCDE'], color: '#8e44ad', bg: '#F4ECF7' },
        ochreGroup: { codes: ['BCE','FPI','AIMA','EEU','AEIOT','FMS','FME','BMT','NM'], color: '#f39c12', bg: '#FFF4E0' },
        tealGroup: { codes: ['IPSSF','EM','FEET','DS','EEMI','BMS','CAED','FFR'], color: '#16a085', bg: '#E8F8F5' },
        redGroup: { codes: ['PD','CS'], color: '#c0392b', bg: '#FDEDEC' },
        slateGroup: { codes: ['GE','FCP','PPS','WD','EW','DPI','DPV','CAD','EVA','MPFL','RDOS','PP'], color: '#34495e', bg: '#F2F4F6' }
    };

    function getGroupData(code) {
        for (const key in window.GROUP_COLOR_MAP) {
            if (window.GROUP_COLOR_MAP[key].codes.includes(code)) return window.GROUP_COLOR_MAP[key];
        }
        return null;
    }

    function hexToRgba(hex, alpha) {
        if (!hex) return '';
        const h = hex.replace('#','');
        const bigint = parseInt(h, 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    function hexToRgb(hex) {
        const h = hex.replace('#','');
        const bigint = parseInt(h, 16);
        return { r: (bigint >> 16) & 255, g: (bigint >> 8) & 255, b: bigint & 255 };
    }

    function readableTextColor(hex) {
        if (!hex) return '#111';
        const {r,g,b} = hexToRgb(hex);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness > 180 ? '#111' : '#ffffff';
    }

    function getGroupColor(code) {
        for (const key in window.GROUP_COLOR_MAP) {
            if (window.GROUP_COLOR_MAP[key].codes.includes(code)) return window.GROUP_COLOR_MAP[key].color;
        }
        return null;
    }

    // --- AUTO-LOGIN & THEME CHECK ---
    window.onload = function() {
        // Theme Check
        const savedTheme = localStorage.getItem('theme');
        if(savedTheme === 'dark') document.body.classList.add('dark-mode');
        // Sync button text
        if (typeof updateThemeButton === 'function') updateThemeButton();
        
        // Login Check
        const savedUser = localStorage.getItem('currentUserMIS');
        if(savedUser && typeof getStudentData === "function") {
            const data = getStudentData(savedUser);
            if(data) {
                loadDashboard(data);
            }
        }
    };

    // --- DARK MODE TOGGLE ---
    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
        localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        if (typeof updateThemeButton === 'function') updateThemeButton();
    }

    function updateThemeButton() {
        const btn = document.getElementById('theme-toggle-btn');
        if (!btn) return;
        const isDark = document.body.classList.contains('dark-mode');
        // Show emoji: üåë for switching to dark, üí° for switching to light
        btn.innerText = isDark ? 'üí°' : 'üåë';
        btn.title = isDark ? 'Switch to light theme' : 'Switch to dark theme';
        btn.setAttribute('aria-label', isDark ? 'Switch to light theme' : 'Switch to dark theme');
    }

    // --- LOGIN LOGIC ---
    const misInput = document.getElementById('mis-input');
    misInput.addEventListener("keypress", (e) => { if (e.key === "Enter") attemptLogin(); });

    function attemptLogin() {
        const entered = misInput.value.trim();
        if(!entered) return;

        // Accept either full 9-digit MIS (e.g. 612515003) or the 5-digit suffix (e.g. 15003)
        const fullMis = entered.length === 9 ? entered : (entered.length === 5 ? ("6125" + entered) : ("6125" + entered));
        const errorMsg = document.getElementById('error-msg');
        const loginCard = document.querySelector('.login-card');

        // Check if data is loaded
        if (typeof getStudentData !== "function") {
            alert("Error: logic.js or students.js not loaded. Please run python script!");
            return;
        }

        // Get Data from logic.js
        const studentData = getStudentData(fullMis);

        if (studentData) {
            localStorage.setItem('currentUserMIS', fullMis);
            loadDashboard(studentData);
        } else {
            errorMsg.style.display = 'block';
            loginCard.classList.add('shake');
            setTimeout(() => loginCard.classList.remove('shake'), 500);
        }
    }

    function loadDashboard(studentData) {
        document.getElementById('home-page').classList.add('hidden');
        document.getElementById('timetable-page').classList.remove('hidden');

        document.getElementById('user-name-display').innerText = studentData.name || "Student";
        const misText = studentData.info || `MIS: ${studentData.mis || '---'}`;
        document.getElementById('user-details-display').innerHTML = misText.replace(/(MIS:\s*)(\d+)/, '$1<strong>$2</strong>');

        const cardContainer = document.getElementById('subject-cards-container');
        cardContainer.innerHTML = "";
        
        // --- SUBJECT GROUP COLOR OVERRIDES ---
        const groupColorMap = {
            // Group 1
            blueGroup: { codes: ['EP','QP','EC'], color: '#2980b9' },
            // Group 2
            purpleGroup: { codes: ['PS','VCDE'], color: '#8e44ad' },
            // Group 3
            ochreGroup: { codes: ['BCE','FPI','AIMA','EEU','AEIOT','FMS','FME','BMT','NM'], color: '#f39c12' },
            // Group 4
            tealGroup: { codes: ['IPSSF','EM','FEET','DS','EEMI','BMS','CAED','FFR'], color: '#16a085' },
            // Group 5
            redGroup: { codes: ['PD','CS'], color: '#c0392b' },
            // Group 6
            slateGroup: { codes: ['GE','FCP','PPS','WD','EW','DPI','DPV','CAD','EVA','MPFL','RDOS','PP'], color: '#34495e' }
        };

        function hexToRgba(hex, alpha) {
            if (!hex) return '';
            const h = hex.replace('#','');
            const bigint = parseInt(h, 16);
            const r = (bigint >> 16) & 255;
            const g = (bigint >> 8) & 255;
            const b = bigint & 255;
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        function getGroupColor(code) {
            for (const key in groupColorMap) {
                if (groupColorMap[key].codes.includes(code)) return groupColorMap[key].color;
            }
            return null;
        }

        if (studentData.cards) {
            studentData.cards.forEach(c => {
                const batchDisplay = (c.batch && c.batch !== '-') ? `<div class="batch">Batch: ${c.batch}</div>` : '';
                const overrideColor = getGroupColor(c.code);
                const groupData = getGroupData(c.code);
                const useColor = (groupData && groupData.color) || c.color || '#dddddd';
                const bgColor = (groupData && groupData.bg) || hexToRgba(useColor, 0.18);
                const textCol = readableTextColor(useColor);
                console.log('CARD COLOR DEBUG:', c.code, 'groupBg=', groupData && groupData.bg, 'final=', useColor, 'text=', textCol);
                cardContainer.innerHTML += `
                    <div class="card" style="border-left:4px solid ${useColor} !important; background: ${bgColor};">
                        <h3>${c.name}</h3>
                        <div class="subject" style="color: ${useColor};">${c.code}</div>
                        <div class="detail" style="color: ${textCol};">${c.div}</div>
                        ${batchDisplay}
                    </div>
                `;
            });
        }

        renderTable(studentData);
        currentUserSchedule = studentData.schedule;
        
        updateClockAndHighlight();
        clockInterval = setInterval(updateClockAndHighlight, 1000);
    }

    // Compute lab emoji if not explicitly provided (delegates to logic.js helper if available)
    function computeLabEmoji(code, room) {
        if (typeof getLabEmoji === 'function') return getLabEmoji(code, room);
        return '';
    }

    function renderTable(studentData) {
        const schedule = studentData.schedule || {};
        const subjectDetails = {};
        
        if (studentData.cards) {
            studentData.cards.forEach(c => {
                subjectDetails[c.code] = { div: c.div, batch: c.batch, color: c.color };
            });
        }

        const tbody = document.getElementById('table-body');
        tbody.innerHTML = "";
        
        const slots = [
            { id: "0830", label: "8:30 - 9:30" }, 
            { id: "0930", label: "9:30 - 10:30" },
            { id: "1030", label: "10:30 - 11:30" }, 
            { id: "1130", label: "11:30 - 12:30" },
            { id: "1230", label: "12:30 - 1:30" },
            { id: "1330", label: "1:30 - 2:30" }, 
            { id: "1430", label: "2:30 - 3:30" },
            { id: "1530", label: "3:30 - 4:30" }, 
            { id: "1630", label: "4:30 - 5:30" },
            { id: "1730", label: "5:30 - 6:30" }
        ];
        
        const days = ["mon", "tue", "wed", "thu", "fri", "sat"];
        const skipped = {}; 

        slots.forEach((slot, index) => {
            // Lunch Logic
            let hasClassAtLunch = false;
            if (slot.id === "1230") {
                hasClassAtLunch = days.some(d => schedule[`${d}-1230`]);
            }

            if (slot.id === "1230" && !hasClassAtLunch) {
                tbody.innerHTML += `<tr><td class="time-col">${slot.label}</td><td colspan="6" class="break" id="lunch-break"><span class="lb-text">LUNCH BREAK</span></td></tr>`;
                return;
            }

            let rowHtml = `<tr><td class="time-col">${slot.label}</td>`;
            
            days.forEach(day => {
                const key = `${day}-${slot.id}`;
                if (skipped[`${day}-${index}`]) return; 

                const item = schedule[key];
                
                if (slot.id === "1230" && !item) {
                     rowHtml += `<td class="break" style="font-size:0.75rem;">Lunch</td>`;
                     return;
                }

                if (item) {
                    // If there are multiple items in the same slot, render a split cell
                    if (Array.isArray(item)) {
                        const itemsArr = item;
                        const rowspan = Math.max(...itemsArr.map(it => it.span || 1));
                        for(let i = 1; i < rowspan; i++) skipped[`${day}-${index + i}`] = true;

                        rowHtml += `
                            <td rowspan="${rowspan}">
                                <div class="slot slot-collision" id="${key}">
                                    <div class="slot-split">
                        `;

                        itemsArr.forEach(it => {
                            const details = subjectDetails[it.subj] || { div: "", batch: "" };
                            const batchInfo = (details.batch && details.batch !== '-') ? `<br>Batch: ${details.batch}` : '';
                            const classStyle = it.class || it.subj.toLowerCase();
                            const groupDataSlot = getGroupData(it.subj);
                            const slotColor = (groupDataSlot && groupDataSlot.color) || (details && details.color) || '#dddddd';
                            const slotBg = (groupDataSlot && groupDataSlot.bg) || hexToRgba(slotColor, 0.20);
                            const slotText = readableTextColor(slotColor);

                            const displayTag = (it.tag && it.tag.trim()) ? it.tag : (it.type === 'lab' ? computeLabEmoji(it.subj, it.room) : '');

                            rowHtml += `
                                <div class="split-item ${classStyle}" style="border-left:4px solid ${slotColor}; background: ${slotBg}; color: ${slotText};">
                                    ${displayTag ? `<div class="lab-tag emoji-top-right">${displayTag}</div>` : ''}
                                    <div class="slot-title" style="font-weight:800; color:${slotColor}; font-size:1.05rem">${it.subj}</div>
                                    ${it.type === 'lab' ? `<div class="slot-sub" style="font-weight:700; color:${slotColor}; font-size:0.9rem;">LAB</div>` : ''}
                                    <span class="room-tag">${it.room}</span>
                                    <div class="extra-info" style="color:${slotText};">
                                        ${details.div}${batchInfo}
                                    </div>
                                </div>`;
                        });

                        rowHtml += `
                                    </div>
                                </div>
                            </td>`;

                    } else {
                        const rowspan = item.span || 1;
                        for(let i = 1; i < rowspan; i++) skipped[`${day}-${index + i}`] = true;
                        
                        const details = subjectDetails[item.subj] || { div: "", batch: "" };
                        const batchInfo = (details.batch && details.batch !== '-') ? `<br>Batch: ${details.batch}` : '';
                        
                        // Fallback for missing class property
                        const classStyle = item.class || item.subj.toLowerCase();
                        const groupDataSlot = getGroupData(item.subj);
                        const slotColor = (groupDataSlot && groupDataSlot.color) || (details && details.color) || '#dddddd';
                        const slotBg = (groupDataSlot && groupDataSlot.bg) || hexToRgba(slotColor, 0.20);
                        const slotText = readableTextColor(slotColor);

                        // Ensure lab emoji shows in top-right: prefer existing tag, else derive from subject/room
                        const displayTag = item.tag || ((item.type === 'lab' && typeof getLabEmoji === 'function') ? getLabEmoji(item.subj, item.room) : '');
                        
                        rowHtml += `
                            <td rowspan="${rowspan}">
                                <div class="slot ${classStyle}" id="${key}" style="border-left:4px solid ${slotColor}; background: ${slotBg}; color: ${slotText};">
                                    ${displayTag ? `<div class="lab-tag emoji-top-right">${displayTag}</div>` : ''}
                                    <div class="slot-title" style="font-weight:800; color:${slotColor}; font-size:1.1rem">${item.subj}</div>
                                    ${item.type === 'lab' ? `<div class="slot-sub" style="font-weight:700; color:${slotColor}; font-size:0.95rem;">LAB</div>` : ''}
                                    <span class="room-tag">${item.room}</span>
                                    <div class="extra-info" style="color:${slotText};">
                                        ${details.div}${batchInfo}
                                    </div>
                                </div>
                            </td>`;
                    }
                } else {
                    rowHtml += `<td id="${key}"></td>`;
                }
            });
            rowHtml += `</tr>`;
            tbody.innerHTML += rowHtml;
        });
        // Enable tap-expand behavior on touch devices so mobile users can reveal details by tapping slots.
        if (typeof enableSlotTapExpand === 'function') enableSlotTapExpand();
    }

    // Mobile: tap to expand/collapse slot info (improves usability on touch devices)
    function enableSlotTapExpand() {
        const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints && navigator.maxTouchPoints > 0);
        if (!isTouch) return;
        const tableBody = document.getElementById('table-body');
        if (!tableBody) return;
        tableBody.querySelectorAll('.slot, .split-item').forEach(el => {
            el.setAttribute('tabindex', '0');
            el.setAttribute('role', 'button');
            el.setAttribute('aria-expanded', 'false');
        });
        tableBody.addEventListener('click', (e) => {
            const el = e.target.closest('.slot, .split-item');
            if (!el) return;
            el.classList.toggle('expanded');
            const expanded = el.classList.contains('expanded');
            el.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        });
        tableBody.addEventListener('keydown', (e) => {
            if (e.key !== 'Enter' && e.key !== ' ') return;
            const el = e.target.closest('.slot, .split-item');
            if (!el) return;
            e.preventDefault();
            el.classList.toggle('expanded');
            const expanded = el.classList.contains('expanded');
            el.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        });
    }

    // Show or hide randomly positioned lunch emojis inside the lunch break cell
    function showLunchEmojis(active) {
        const lb = document.getElementById('lunch-break');
        if (!lb) return;
        // Ensure the LUNCH BREAK text is wrapped in .lb-text (in case it's older markup)
        if (!lb.querySelector('.lb-text')) {
            const txt = lb.textContent.trim();
            lb.textContent = '';
            const spanText = document.createElement('span');
            spanText.className = 'lb-text';
            spanText.textContent = txt;
            lb.appendChild(spanText);
        }

        if (active) {
            if (lb.classList.contains('lunch-now')) return; // already active
            lb.classList.add('lunch-now');

            // Create a small continuous stream of emojis (each animates from bottom to top)
            const count = 5 + Math.floor(Math.random() * 4); // 5-8 emojis
            for (let i = 0; i < count; i++) {
                const span = document.createElement('span');
                span.className = 'lunch-emoji';
                span.innerText = 'üçΩÔ∏è';
                const left = 8 + Math.random() * 84;
                span.style.left = `${left}%`;
                span.style.fontSize = `${14 + Math.random() * 18}px`;
                const dur = (3 + Math.random() * 4).toFixed(2) + 's';
                span.style.animationDuration = dur;
                // Negative delay so it starts mid-flight for continuity
                span.style.animationDelay = `-${(Math.random() * parseFloat(dur)).toFixed(2)}s`;
                lb.appendChild(span);
            }
        } else {
            lb.classList.remove('lunch-now');
            lb.querySelectorAll('.lunch-emoji').forEach(e => e.remove());
        }
    }

    // Snowfall overlay helpers for live slots
    function addSnowfallToSlot(el) {
        if (!el || el.querySelector('.snowfall')) return;
        const container = document.createElement('div');
        container.className = 'snowfall';
        // Fewer flakes for subtler, smoother snowfall
        const flakes = 10 + Math.floor(Math.random() * 8); // 10-17 flakes
        for (let i = 0; i < flakes; i++) {
            const f = document.createElement('span');
            f.className = 'snowflake';
            f.innerText = '‚ùÑÔ∏è';
            // Horizontal spread
            f.style.left = (Math.random() * 94 + 3) + '%';
            // Random negative start so flakes are already mid-fall
            f.style.top = (-10 - Math.random() * 100) + '%'; // -10% to -110%
            // Size varied (smaller overall)
            f.style.fontSize = (10 + Math.random() * 14) + 'px';
            // Fall duration (6-12s) and sway duration (3-5s)
            const fallDur = (6 + Math.random() * 6).toFixed(2);
            const swayDur = (3 + Math.random() * 2).toFixed(2);
            f.style.animationDuration = `${fallDur}s, ${swayDur}s`;
            // Negative delay so flakes appear mid-fall for continuity
            const fallDelay = -(Math.random() * parseFloat(fallDur)).toFixed(2);
            const swayDelay = -(Math.random() * parseFloat(swayDur)).toFixed(2);
            f.style.animationDelay = `${fallDelay}s, ${swayDelay}s`;
            // Softer opacity for subtleness
            f.style.opacity = (0.22 + Math.random() * 0.24).toFixed(2);
            container.appendChild(f);
        }
        el.appendChild(container);
    }

    function removeSnowfallFromSlot(el) {
        if (!el) return;
        const s = el.querySelector('.snowfall');
        if (s) s.remove();
    }

    function logout() {
        localStorage.removeItem('currentUserMIS');
        document.getElementById('timetable-page').classList.add('hidden');
        document.getElementById('home-page').classList.remove('hidden');
        clearInterval(clockInterval);
        misInput.value = ""; 
        document.getElementById('error-msg').style.display = 'none';
    }

    function updateClockAndHighlight() {
        const now = new Date();
        const daysArr = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const dayIndex = now.getDay();
        const clockEl = document.getElementById('clock');
        if(clockEl) {
            clockEl.innerText = `${daysArr[dayIndex]}, ${now.toLocaleTimeString('en-US', { hour12: true, hour: '2-digit', minute: '2-digit', second: '2-digit' })}`;
        }

        // Remove previous live highlights and any snowfall overlays
        document.querySelectorAll('.live-active').forEach(el => {
            el.classList.remove('live-active');
            removeSnowfallFromSlot(el);
        });
        document.querySelectorAll('.current-day-col').forEach(el => el.classList.remove('current-day-col'));

        // Ensure lunch visuals are off before we compute (they will be toggled below)
        showLunchEmojis(false);

        if (dayIndex === 0 || !currentUserSchedule) return;

        const dayPrefix = daysArr[dayIndex].toLowerCase();
        document.getElementById(`th-${dayPrefix}`)?.classList.add('current-day-col');
        
        const mins = now.getHours() * 60 + now.getMinutes();
        let currentSlotId = null;

        if (mins >= 510 && mins < 570) currentSlotId = "0830";
        else if (mins >= 570 && mins < 630) currentSlotId = "0930";
        else if (mins >= 630 && mins < 690) currentSlotId = "1030";
        else if (mins >= 690 && mins < 750) currentSlotId = "1130";
        else if (mins >= 750 && mins < 810) currentSlotId = "1230";
        else if (mins >= 810 && mins < 870) currentSlotId = "1330";
        else if (mins >= 870 && mins < 930) currentSlotId = "1430";
        else if (mins >= 930 && mins < 990) currentSlotId = "1530";
        else if (mins >= 990 && mins < 1050) currentSlotId = "1630";
        else if (mins >= 1050 && mins < 1110) currentSlotId = "1730";

        // Handle lunch-specific visuals
        if (currentSlotId === '1230') {
            // If lunch row exists, activate lunch visuals (emojis, border)
            showLunchEmojis(true);
        } else {
            showLunchEmojis(false);
        }

        if (currentSlotId) {
            let key = `${dayPrefix}-${currentSlotId}`;
            let el = document.getElementById(key);

            if (!el) {
                // Check previous slot for labs (2-hour slots)
                const slotsList = ["0830", "0930", "1030", "1130", "1230", "1330", "1430", "1530", "1630", "1730"];
                const prevSlotIndex = slotsList.indexOf(currentSlotId) - 1;
                
                if(prevSlotIndex >= 0) {
                     const prevSlotId = slotsList[prevSlotIndex];
                     const prevKey = `${dayPrefix}-${prevSlotId}`;
                     const prevItem = currentUserSchedule[prevKey];
                     if(prevItem && prevItem.span === 2) el = document.getElementById(prevKey);
                }
            }
            if (el && el.classList.contains('slot')) {
                el.classList.add('live-active');
                addSnowfallToSlot(el);
            }
        } else {
            // ensure lunch emojis are hidden when there's no active slot (non-lunch minutes)
            // showLunchEmojis(false) already called above
        }
    }
</script>

</body>
</html>
